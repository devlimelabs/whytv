<div class="relative w-full h-full bg-black" (click)="handleTap($event)">
  <!-- YouTube Player Container -->
  <div id="youtube-player" class="w-full h-full"></div>

  <!-- Loading Indicator -->
  @if (isLoading()) {
  <div class="absolute inset-0 flex items-center justify-center bg-black/50">
    <div
      class="w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"
    ></div>
  </div>
  }

  <!-- Error Message -->
  @if (error()) {
  <div class="absolute inset-0 flex items-center justify-center bg-black/50">
    <div class="bg-red-500/90 text-white px-4 py-2 rounded-lg shadow-lg">
      {{ error() }}
    </div>
  </div>
  }

  <!-- Muted Indicator - Show when video is muted and playing -->
  @if (isMuted() && isPlaying() && !isLoading() && playerReady()) {
  <div
    class="absolute top-8 left-1/2 transform -translate-x-1/2 bg-black/70 text-white px-5 py-3 rounded-lg shadow-lg flex items-center gap-3 z-30"
  >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
      class="lucide lucide-volume-x"
    >
      <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" />
      <line x1="23" x2="17" y1="9" y2="15" />
      <line x1="17" x2="23" y1="9" y2="15" />
    </svg>
    <span class="text-base font-medium">Tap to unmute</span>
  </div>
  }

  <!-- Play/Pause Button (completely separate from other controls) -->
  <div
    class="absolute inset-0 flex items-center justify-center transition-all z-20 duration-300"
    [ngClass]="showPlayPauseButton() ? 'opacity-100' : 'opacity-0'"
  >
    <button
      class="w-16 h-16 bg-black/30 rounded-full flex items-center justify-center transition-transform hover:scale-125 hover:bg-black/50 cursor-pointer"
      (click)="$event.stopPropagation(); handlePlayPause()"
      [attr.aria-label]="isPlaying() ? 'Pause' : 'Play'"
    >
      @if (isPlaying()) {
      <lucide-icon [img]="Pause" class="w-8 h-8 text-white" />
      } @else {
      <lucide-icon [img]="Play" class="w-8 h-8 text-white" />
      }
    </button>
  </div>

  <!-- Side Controls (separate from play/pause button) -->
  <div
    class="absolute inset-0 transition-opacity duration-300"
    [ngClass]="showControls() ? 'opacity-100' : 'opacity-0'"
  >
    <!-- Side Actions Component -->
    <app-side-actions
      [isMuted]="isMuted()"
      [liked]="liked()"
      [showControls]="showControls()"
      (muteToggle)="toggleMute($event)"
      (likeToggle)="toggleLike($event)"
      (commentToggle)="handleComment($event)"
      (shareToggle)="handleShare($event)"
      (nextVideo)="handleNextVideo($event)"
      (previousVideo)="handlePreviousVideo($event)"
    />

    <!-- Video Info -->
    <div
      class="absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/60 to-transparent"
    >
      <h2 class="text-white text-xl font-medium">{{ video().title }}</h2>
      <p class="text-white/80 text-sm">{{ video().channelName }}</p>
    </div>

    <!-- Progress Bar -->
    <div class="absolute bottom-0 left-0 right-0 h-1 bg-white/20">
      <div
        class="h-full bg-white transition-all duration-300"
        [style.width.%]="progress()"
      ></div>
    </div>
  </div>
</div>
